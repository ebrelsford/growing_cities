<!DOCTYPE html>
{% load compress fiber_tags %}
<html>
<head>
	<meta charset="utf-8" />
	<title>{% block title %}{{ fiber_page.title }}{% endblock %}</title>
    <link rel="icon" href="{{ STATIC_URL }}img/favicon.ico" />

    {% compress css %}
	<link rel="stylesheet" href="{{ STATIC_URL }}css/base.css">
	<link rel="stylesheet" href="{{ STATIC_URL }}js/lib/chosen/chosen.css">
    {% endcompress %}

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.0/jquery-ui.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
    <![endif]-->
    <script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>

    {% block scripts %}{% endblock %}

    {% compress js %}
    <script type="text/javascript">
    WebFontConfig = { fontdeck: { id: '30649' } };

    (function() {
        var wf = document.createElement('script');
        wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
            '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
        wf.type = 'text/javascript';
        wf.async = 'true';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(wf, s);
    })();
    </script>
    <!-- Dynamically load pages -->
    <script src="{{ STATIC_URL }}js/lib/jquery.scrollto.min.js"></script>
    <script src="{{ STATIC_URL }}js/lib/jquery.history.js"></script>
    <script defer src="{{ STATIC_URL }}js/jquery.ajaxpages.js"></script>  

    {% comment %}
    Only load jquery.form.js if not logged in--conflicts with Django Fiber 
    version. (TODO fix this?)
    {% endcomment %}
    {% if not fiber_page|can_edit:user %}
    <script defer src="{{ STATIC_URL }}js/lib/jquery.form.js"></script>  
    {% endif %}
    <script defer src="{{ STATIC_URL }}js/lib/jquery.placeholder.js"></script>  
    <script defer src="{{ STATIC_URL }}js/lib/jquery.smartresize.js"></script>  
    <script src="{{ STATIC_URL }}js/lib/jquery.waypoints.min.js"></script>
    <script src="{{ STATIC_URL }}js/lib/jquery.waypoints-sticky.min.js"></script>

    <script src="{{ STATIC_URL }}js/lib/chosen/chosen.jquery.min.js"></script>

    {% comment %}
    For Django Fiber code that uses bits jQuery no longer supports.
    {% endcomment %}
    <script src="{{ STATIC_URL }}js/lib/jquery-migrate-1.1.1.min.js"></script>

    <script src="{{ STATIC_URL }}js/main.js"></script>
    <script src="{{ STATIC_URL }}js/leaflet.offset.js"></script>
    <script src="{{ STATIC_URL }}js/leaflet.mapdrawer.js"></script>
    <script src="{{ STATIC_URL }}js/jquery.map.js"></script>
    {% if fiber_page|can_edit:user %}
    <script src="{{ STATIC_URL }}js/loggedin.js"></script>  
    {% endif %}
    {% endcompress %}
</head>
<body class="{% block body_class %}{{ fiber_page.title|slugify }}{% endblock %}">
	<div>
		<div>
			<div id="sidebar" class="full-height grid grid-1-4">
                <section id="logo">
                    <h1>
                        <a href="/">Growing<br />Cities</a>
                    </h1>
                </section>
				<nav id="mainmenu" class="clearfix">
					{% show_menu "mainmenu" 1 1 %}
				</nav>

                <div class="sidebar-section">
                    <a href="#" id="trailer-button">watch trailer</a>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-name">Latest News</div>
                    <div>
                        {% show_content "latest_news" %}
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-section-name">Sign up to get involved</div>
                    <div>
                        {% include "_mailing_list_form.html" %}
                    </div>
                </div>

                <div class="sidebar-section">
                    {% show_content "terms" %}
                </div>

			</div>

            <div id="content" class="full-height grid grid-3-4">
				<article>
                    {% block content %}
					{% show_page_content "main" %}
                    {% endblock %}
				</article>
			</div>

		</div>
	</div>
    {% block extra_markup %}{% endblock %}
</body>
</html>
