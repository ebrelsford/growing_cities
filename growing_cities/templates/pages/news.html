{% extends "pages/base.html" %}
{% load cache fiber_tags rsssync_tags twittersync_tags %}

{% block page_content %}
<div class="news lead-in">
    {% show_page_content "lead-in" %}
</div>

<div>

    <div class="grid grid-1-4">

        <div class="news-signup">
            <script>
                $(document).ready(function() {
                    $('#signup-form').load('{% url "newsletter:form" %}', function() {
                        $(document.body).ajaxify();

                        $('#signup-form form').submit(function() {
                            $(this).find(':input[type=submit]').attr('disabled', 'disabled');
                            $(this).addClass('submitting');
                        });
                    });
                });
            </script>

            <div class="signup lead-in">
                {% show_page_content "signup-lead-in" %}
            </div>

            <div id="signup-form" class="ajax-form-wrapper"></div>
        </div>

        <div class="news-twitter">
            <div>The Latest</div>
            <div class="meta twitter-via">via twitter</div>

            {% get_latest_tweets "GrowinCities" 5 as "tweets" %}
            <ul class="tweets">
                {% for tweet in tweets %}
                <li class="tweet">
                    <div class="tweet-content">{{ tweet.content|urlize|safe }}</div>
                    at <a class="twitter-date" href="{{ tweet.url }}" target="_blank">{{ tweet.created_date }}</a>
                </li>
                {% endfor %}
            </ul>
        </div>

        <div class="news-blogroll">
            {% show_page_content "blogroll" %}
        </div>
    </div>

    <div class="grid grid-3-4 news-wordpress">

        {% get_latest_entries "Growing Cities Blog" 5 as "entries" %}
        <ul class="wordpress-posts">
            {% for entry in entries %}
            <li class="wordpress-post">
                <div class="wordpress-title">
                    {{ entry.title }}
                </div>
                <div class="meta wordpress-date">{{ entry.date|date:"F j, Y" }}</div>
                <div class="wordpress-summary">{{ entry.summary|safe }}</div>
            </li>
            {% endfor %}
        </ul>
    </div>

</div>
{% endblock %}
